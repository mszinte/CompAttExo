function gaussian = GenerateGaussian(m, n, sigma1,sigma2, theta,xoff,yoff)% generates a 2D gaussian with a given patch size, sd, orientation and offset% gaussian = GenerateGaussian(256,256, 32,32, pi/2,0,0); ishow(gaussian)% J Greenwood 2009m = round(m);n = round(n);[X,Y] = meshgrid(-m/2:m/2-1,-n/2:n/2-1);X     = X-xoff;Y     = Y-yoff;% speedy variablesc1 = cos(pi-theta);s1 = sin(pi-theta);sig1_squared = 2*sigma1*sigma1;sig2_squared = 2*sigma2*sigma2;% co-ordinate matricesXt = zeros(m,n);Yt = zeros(m,n);% rotate co-ordinatesXt = X.*c1 + Y.*s1;Yt = Y.*c1 - X.*s1;gaussian = exp(-(Xt.*Xt)/sig1_squared-(Yt.*Yt)/sig2_squared);end